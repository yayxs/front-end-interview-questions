<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>手写实现深浅拷贝（深浅克隆） | TOP-FE-IQA</title>
    <meta name="generator" content="VuePress 1.6.0">
    
    <meta name="description" content="Top X Front-End  Interview Questions and Answers">
    <link rel="preload" href="/assets/css/0.styles.a748b10c.css" as="style"><link rel="preload" href="/assets/js/app.06527024.js" as="script"><link rel="preload" href="/assets/js/2.be1a4e3a.js" as="script"><link rel="preload" href="/assets/js/84.e42a6c85.js" as="script"><link rel="prefetch" href="/assets/js/10.b1d27394.js"><link rel="prefetch" href="/assets/js/100.ce3d5bd1.js"><link rel="prefetch" href="/assets/js/11.36f3f546.js"><link rel="prefetch" href="/assets/js/12.6fc44304.js"><link rel="prefetch" href="/assets/js/13.edb6a380.js"><link rel="prefetch" href="/assets/js/14.32d905d3.js"><link rel="prefetch" href="/assets/js/15.fb8751ba.js"><link rel="prefetch" href="/assets/js/16.d53a9b99.js"><link rel="prefetch" href="/assets/js/17.cfee367f.js"><link rel="prefetch" href="/assets/js/18.57b46b98.js"><link rel="prefetch" href="/assets/js/19.5f6c1ec1.js"><link rel="prefetch" href="/assets/js/20.1a38e484.js"><link rel="prefetch" href="/assets/js/21.44414be4.js"><link rel="prefetch" href="/assets/js/22.e8583e00.js"><link rel="prefetch" href="/assets/js/23.3a02411d.js"><link rel="prefetch" href="/assets/js/24.3d9e008e.js"><link rel="prefetch" href="/assets/js/25.031605c2.js"><link rel="prefetch" href="/assets/js/26.c1f8d597.js"><link rel="prefetch" href="/assets/js/27.c26d8eb7.js"><link rel="prefetch" href="/assets/js/28.da439d0c.js"><link rel="prefetch" href="/assets/js/29.846c5219.js"><link rel="prefetch" href="/assets/js/3.6891ca5a.js"><link rel="prefetch" href="/assets/js/30.555cb7d8.js"><link rel="prefetch" href="/assets/js/31.a00ae083.js"><link rel="prefetch" href="/assets/js/32.59824dae.js"><link rel="prefetch" href="/assets/js/33.d96f9909.js"><link rel="prefetch" href="/assets/js/34.9373d8f4.js"><link rel="prefetch" href="/assets/js/35.cebade29.js"><link rel="prefetch" href="/assets/js/36.ac70a868.js"><link rel="prefetch" href="/assets/js/37.a7a6917e.js"><link rel="prefetch" href="/assets/js/38.99f95504.js"><link rel="prefetch" href="/assets/js/39.c200a0e3.js"><link rel="prefetch" href="/assets/js/4.2d7b3ab8.js"><link rel="prefetch" href="/assets/js/40.b666bd70.js"><link rel="prefetch" href="/assets/js/41.3c43d819.js"><link rel="prefetch" href="/assets/js/42.00812754.js"><link rel="prefetch" href="/assets/js/43.d058b8e3.js"><link rel="prefetch" href="/assets/js/44.fdf14993.js"><link rel="prefetch" href="/assets/js/45.435b55d4.js"><link rel="prefetch" href="/assets/js/46.5800c7a9.js"><link rel="prefetch" href="/assets/js/47.9490f850.js"><link rel="prefetch" href="/assets/js/48.564def0d.js"><link rel="prefetch" href="/assets/js/49.d0a8661a.js"><link rel="prefetch" href="/assets/js/5.80ccce99.js"><link rel="prefetch" href="/assets/js/50.1620ed2c.js"><link rel="prefetch" href="/assets/js/51.07802042.js"><link rel="prefetch" href="/assets/js/52.ed0d2680.js"><link rel="prefetch" href="/assets/js/53.f56d3974.js"><link rel="prefetch" href="/assets/js/54.ae713fb7.js"><link rel="prefetch" href="/assets/js/55.4bdfc10e.js"><link rel="prefetch" href="/assets/js/56.27b4b261.js"><link rel="prefetch" href="/assets/js/57.99b14dd2.js"><link rel="prefetch" href="/assets/js/58.6eafe902.js"><link rel="prefetch" href="/assets/js/59.f42f8172.js"><link rel="prefetch" href="/assets/js/6.ecda80e6.js"><link rel="prefetch" href="/assets/js/60.6b41577e.js"><link rel="prefetch" href="/assets/js/61.35e028db.js"><link rel="prefetch" href="/assets/js/62.aea20c8c.js"><link rel="prefetch" href="/assets/js/63.ff73f896.js"><link rel="prefetch" href="/assets/js/64.933fd5d3.js"><link rel="prefetch" href="/assets/js/65.ff1a6438.js"><link rel="prefetch" href="/assets/js/66.f30e8beb.js"><link rel="prefetch" href="/assets/js/67.f0cbd400.js"><link rel="prefetch" href="/assets/js/68.4fafe01f.js"><link rel="prefetch" href="/assets/js/69.0b2eb282.js"><link rel="prefetch" href="/assets/js/7.c2760c65.js"><link rel="prefetch" href="/assets/js/70.65e0f501.js"><link rel="prefetch" href="/assets/js/71.cb5c4275.js"><link rel="prefetch" href="/assets/js/72.0cd55dcb.js"><link rel="prefetch" href="/assets/js/73.b5b22c5e.js"><link rel="prefetch" href="/assets/js/74.0b5b5510.js"><link rel="prefetch" href="/assets/js/75.e08ae12d.js"><link rel="prefetch" href="/assets/js/76.4fe1d01c.js"><link rel="prefetch" href="/assets/js/77.057a691f.js"><link rel="prefetch" href="/assets/js/78.fd937e85.js"><link rel="prefetch" href="/assets/js/79.02bc11fd.js"><link rel="prefetch" href="/assets/js/8.126a031f.js"><link rel="prefetch" href="/assets/js/80.a65847e4.js"><link rel="prefetch" href="/assets/js/81.75de558f.js"><link rel="prefetch" href="/assets/js/82.68f92944.js"><link rel="prefetch" href="/assets/js/83.5a67ba91.js"><link rel="prefetch" href="/assets/js/85.e703f158.js"><link rel="prefetch" href="/assets/js/86.c08974ab.js"><link rel="prefetch" href="/assets/js/87.ed37167d.js"><link rel="prefetch" href="/assets/js/88.a7c3a374.js"><link rel="prefetch" href="/assets/js/89.327dbc04.js"><link rel="prefetch" href="/assets/js/9.a71a7fa4.js"><link rel="prefetch" href="/assets/js/90.cf98dd80.js"><link rel="prefetch" href="/assets/js/91.1d8b486c.js"><link rel="prefetch" href="/assets/js/92.4dc5c396.js"><link rel="prefetch" href="/assets/js/93.be91f2c1.js"><link rel="prefetch" href="/assets/js/94.69047918.js"><link rel="prefetch" href="/assets/js/95.555e6aea.js"><link rel="prefetch" href="/assets/js/96.2cf4886d.js"><link rel="prefetch" href="/assets/js/97.4914b9ef.js"><link rel="prefetch" href="/assets/js/98.4a53e600.js"><link rel="prefetch" href="/assets/js/99.234f1a95.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a748b10c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">TOP-FE-IQA</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guides/" class="nav-link router-link-active">
  指南
</a></div><div class="nav-item"><a href="https://github.com/yayxs/top-fe-iqa" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guides/" class="nav-link router-link-active">
  指南
</a></div><div class="nav-item"><a href="https://github.com/yayxs/top-fe-iqa" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前言</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guides/" aria-current="page" class="sidebar-link">食用指南</a></li><li><a href="/guides/contact.html" class="sidebar-link">前端互鱼</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>HTML/HTML5</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guides/html/" class="sidebar-link">HTML常考面试题汇总</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>CSS/CSS3</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guides/css/box_model.html" class="sidebar-link">是否了解盒模型 介绍一下标准的 CSS 盒子模型 与低版本的 IE 盒子模型有什么不同 box-sizing常用的属性有哪些? 分别有啥作用?</a></li><li><a href="/guides/css/bfc.html" class="sidebar-link">你知道什么是 BFC 吗 BFC 的布局规则是什么？如何创建 BFC？</a></li><li><a href="/guides/css/center.html" class="sidebar-link">css布局方式水平垂直布局的实现</a></li><li><a href="/guides/css/selector.html" class="sidebar-link">请说说css的选择器以及选择器优先级</a></li><li><a href="/guides/css/clearfix.html" class="sidebar-link">什么时候清除浮动？如何清除浮动？原理是什么</a></li><li><a href="/guides/css/hide.html" class="sidebar-link">隐藏页面中的元素有哪些方式?</a></li><li><a href="/guides/css/position.html" class="sidebar-link">请你说说css的定位position</a></li><li><a href="/guides/css/display.html" class="sidebar-link">display有哪些值，以及作用</a></li><li><a href="/guides/css/float.html" class="sidebar-link">浮动元素和绝对定位元素的区别和应用?</a></li><li><a href="/guides/css/normalize.html" class="sidebar-link">css reset 和 normalize.css 有什么区别</a></li><li><a href="/guides/css/link_import.html" class="sidebar-link">Link 与 @import导入css的区别</a></li><li><a href="/guides/css/triangle.html" class="sidebar-link">请利用纯css画一个三角形，原理是什么</a></li><li><a href="/guides/css/z_index.html" class="sidebar-link">z-index 有什么需要注意的地方</a></li><li><a href="/guides/css/unit.html" class="sidebar-link">css单位有哪些以及它们的区别</a></li><li><a href="/guides/css/font.html" class="sidebar-link">在网页中的应该使用奇数还是偶数的字体？自定义字体的使用场景</a></li><li><a href="/guides/css/vertical_align.html" class="sidebar-link">CSS 中的 vertical-align 有哪些值？它在什么情况下才能生效？</a></li><li><a href="/guides/css/img.html" class="sidebar-link">img 下的间隙3px的原理</a></li><li><a href="/guides/css/base64.html" class="sidebar-link">谈谈你对base64 的理解以及使用场景</a></li><li><a href="/guides/css/pseudo_classes_elements.html" class="sidebar-link">伪类和伪元素的区别是什么呢 ？css3 新增的伪类有哪些</a></li><li><a href="/guides/css/flex.html" class="sidebar-link">请你谈谈Flexbox布局</a></li><li><a href="/guides/css/responsive.html" class="sidebar-link">如何理解响应式与是自适应</a></li><li><a href="/guides/css/animation.html" class="sidebar-link">css中动画常考面试题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JavaScript/ES6</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guides/js/type_of_data.html" class="sidebar-link">JavaScript的数据类型有哪些,存储有什么区别？</a></li><li><a href="/guides/js/0.3.html" class="sidebar-link">不精确的计算之为什么 0.1 + 0.2 != 0.3</a></li><li><a href="/guides/js/var_let_const.html" class="sidebar-link">var、let 和 const 区别的实现原理是?</a></li><li><a href="/guides/js/null_undefined.html" class="sidebar-link">null和undefined有什么区别</a></li><li><a href="/guides/js/typeof_instanceof.html" class="sidebar-link">typeof 和 instance of 检测数据类型有什么区别？</a></li><li><a href="/guides/js/map.html" class="sidebar-link">Set、Map、WeakSet 和 WeakMap 的区别</a></li><li><a href="/guides/js/scope.html" class="sidebar-link">谈谈作用域与作用域链的理解，如何理解?</a></li><li><a href="/guides/js/es6.html" class="sidebar-link">es6 的新特性都有哪些？</a></li><li><a href="/guides/js/cycle.html" class="sidebar-link">for..of, for..in和 forEach,map 的区别</a></li><li><a href="/guides/js/create_obj.html" class="sidebar-link">创建对象的方式</a></li><li><a href="/guides/js/equalityOperator.html" class="sidebar-link">==和===区别是什么？</a></li><li><a href="/guides/js/use_strict.html" class="sidebar-link">严格模式对函数有哪些限制</a></li><li><a href="/guides/js/func_args.html" class="sidebar-link">函数的参数以什么方式传递的</a></li><li><a href="/guides/js/context.html" class="sidebar-link">说说你对执行上下文的理解?</a></li><li><a href="/guides/js/hoisting.html" class="sidebar-link">JS中的变量声明提升</a></li><li><a href="/guides/js/for_var.html" class="sidebar-link">网红经典面试题：for循环中的var声明</a></li><li><a href="/guides/js/garbage_collection.html" class="sidebar-link">谈谈JS中的垃圾回收机制</a></li><li><a href="/guides/js/performance.html" class="sidebar-link">如何提升 JavaScript 变量的存储性能？</a></li><li><a href="/guides/js/ram.html" class="sidebar-link">JS中的内存泄漏的理解？</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>专题系列</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guides/js/array/" class="sidebar-link">数组常考面试题汇总</a></li><li><a href="/guides/optimization/" class="sidebar-link">性能优化常考面试题汇总</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>笔试手写</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guides/written/debounce.html" class="sidebar-link">手写实现防抖函数（debounce）</a></li><li><a href="/guides/written/throttle.html" class="sidebar-link">手写实现节流函数（throttle）</a></li><li><a href="/guides/written/clone.html" aria-current="page" class="active sidebar-link">手写实现深浅拷贝（深浅克隆）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guides/written/clone.html#背景" class="sidebar-link">背景</a></li><li class="sidebar-sub-header"><a href="/guides/written/clone.html#浅拷贝" class="sidebar-link">浅拷贝</a></li><li class="sidebar-sub-header"><a href="/guides/written/clone.html#深拷贝" class="sidebar-link">深拷贝</a></li></ul></li><li><a href="/guides/written/new.html" class="sidebar-link">手写实现New操作符</a></li><li><a href="/guides/written/call.html" class="sidebar-link">手写实现call与apply</a></li><li><a href="/guides/written/bind.html" class="sidebar-link">手写实现bind 函数</a></li><li><a href="/guides/written/instanceof.html" class="sidebar-link">手写实现instanceof运算符</a></li><li><a href="/guides/written/trim.html" class="sidebar-link">手写实现trim方法</a></li><li><a href="/guides/written/event.html" class="sidebar-link">手写实现EventBus/EventEmitter</a></li><li><a href="/guides/written/unique.html" class="sidebar-link">手写实现数组去重的方法</a></li><li><a href="/guides/written/promise.html" class="sidebar-link">手写实现promise</a></li><li><a href="/guides/written/promise_all.html" class="sidebar-link">手动实现promise.all</a></li><li><a href="/guides/written/promise_finally.html" class="sidebar-link">手动实现promise.finally</a></li><li><a href="/guides/written/triangle.html" class="sidebar-link">手写实现输出由*号组成的三角形</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>计算机网络</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guides/network/http/input_url.html" class="sidebar-link">当在网页浏览器的地址栏输入url后，发生了什么？</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>设计模式</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guides/design_patterns/" class="sidebar-link">JavaScript设计模式</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>框架VUE</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guides/vue/communication.html" class="sidebar-link">Vue 组件中的参数如何传递？如何进行通信</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>WebPack</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据结构与算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>场景题目</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guides/scene/00.html" class="sidebar-link">递归删除null 节点（node）</a></li><li><a href="/guides/scene/01.html" class="sidebar-link">判断字符串是否为合法的IP地址</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="手写实现深浅拷贝-深浅克隆"><a href="#手写实现深浅拷贝-深浅克隆" class="header-anchor">#</a> 手写实现深浅拷贝（深浅克隆）</h1> <h2 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h2> <blockquote><p>深浅拷贝 是面试中的<code>明星话题</code></p></blockquote> <p><strong>首先明确一点我们接下来探讨的都是引用类型，一般我们拷贝的也就是像数组对象这种较为复杂的数据类型</strong></p> <p>什么是引用类型，我下边举个例子，也就是说 你和弟弟都是家里的人 一旦你弟弟 改变了你家的布局，那么你俩拿钥匙回到家看到的是一样的，都是改变后的样子 也就是说 你俩是一家人（这里就不用女朋友举例了）</p> <p>如何切断数据，就是重新拷贝一份 浅拷贝就是表面的拷贝</p> <ul><li>深拷贝就是无限层级的拷贝下去</li></ul> <h2 id="浅拷贝"><a href="#浅拷贝" class="header-anchor">#</a> 浅拷贝</h2> <p>先来说说浅拷贝，浅拷贝:创建一个新对象，有旧对象原始属性值（基本类型，拷贝的是基本类型；引用类型，便是内存地址）一份精确拷贝
其中一个对象地址改变，相互影响（也就是说虽然拷贝过了，但是还是会相互影响的）</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;张三&quot;</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> obj2 <span class="token operator">=</span> obj1<span class="token punctuation">;</span>
obj2<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;李四&quot;</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 此时第一个对象的name属性就被改掉了</span>
</code></pre></div><p>我们发现，我们通过一个简单的 <code>赋值操作来完成这一操作</code> 那我们是不是也可以通过一个简单的函数来实现，那就是</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">shallow</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> prop <span class="token keyword">in</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    obj<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">=</span> target<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>从数组来看的话</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> targetArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">'oldName'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">]</span>

<span class="token keyword">let</span> resultArr <span class="token operator">=</span> targetArr<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
resultArr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'newName'</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'old'</span><span class="token punctuation">,</span>targetArr<span class="token punctuation">)</span> <span class="token comment">// 此时 targetArr 的第一个元素的 name 也被修改了</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'new'</span><span class="token punctuation">,</span>resultArr<span class="token punctuation">)</span>
</code></pre></div><h3 id="具体实现"><a href="#具体实现" class="header-anchor">#</a> 具体实现</h3> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">function</span> <span class="token function">firstShallowClone</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> target <span class="token operator">!==</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token keyword">return</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> k <span class="token keyword">in</span> target<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            result<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> target<span class="token punctuation">[</span>k<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result
<span class="token punctuation">}</span>
</code></pre></div><h2 id="深拷贝"><a href="#深拷贝" class="header-anchor">#</a> 深拷贝</h2> <p>深拷贝的核心思路便是 拷贝加递归 也就是说当对象的某一个属性还是个对象的时候，我们需要对之进一步拷贝,从内存完整拷贝，在堆中重新开启区间，对象地址改变不会影响</p> <h3 id="第一个深拷贝-通过json的两个api"><a href="#第一个深拷贝-通过json的两个api" class="header-anchor">#</a> 第一个深拷贝：通过<code>JSON</code>的两个API</h3> <ul><li>JSON.parse() 方法用来解析 JSON 字符串，构造由字符串描述的 JavaScript 值或对象</li> <li>JSON.stringify() 方法将一个 JavaScript 值（对象或者数组）转换为一个 JSON 字符串</li></ul> <p>实现 JavaScript 中的深拷贝，有一种非常取巧的方式 —— JSON.stringify,</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;yayxs&quot;</span><span class="token punctuation">,</span>
  fav<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token string">&quot;play&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  friend<span class="token operator">:</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;wanghuahua&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> objStr <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token comment">// deepClone.js:16 {&quot;name&quot;:&quot;yayxs&quot;,&quot;fav&quot;:[{&quot;type&quot;:&quot;play&quot;}],&quot;friend&quot;:{&quot;name&quot;:&quot;wanghuahua&quot;}}</span>
<span class="token keyword">const</span> objCopy <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>objStr<span class="token punctuation">)</span>



objCopy<span class="token punctuation">.</span>fav<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span><span class="token string">'fav'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// [{}]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>objCopy<span class="token punctuation">[</span><span class="token string">'fav'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">//[]</span>
</code></pre></div><p>但是如果单个元素是函数的话，我们来试一下</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">let</span> fnArr <span class="token operator">=</span> <span class="token punctuation">[</span>

    <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>fnArr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [null, null]</span>
</code></pre></div><h3 id="第二个深拷贝-递归拷贝"><a href="#第二个深拷贝-递归拷贝" class="header-anchor">#</a> 第二个深拷贝：递归拷贝</h3> <p>判断一下属性值的类型，当目前属性值的类型是个对象的时候，然后递归克隆，</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">firstDeepClone</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//  如果是 值类型 或 null，则直接return</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> target <span class="token operator">!==</span> <span class="token string">'object'</span> <span class="token operator">||</span>target<span class="token operator">===</span><span class="token keyword">null</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> target
  <span class="token punctuation">}</span>
  <span class="token comment">// 结果对象</span>
  <span class="token keyword">let</span> res <span class="token operator">=</span> target <span class="token keyword">instanceof</span> <span class="token class-name">Array</span> <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> res<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">// 首先判断当前key 所对应的属性值是否是个引用类型</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        res<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">firstDeepClone</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        res<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guides/written/throttle.html" class="prev">
        手写实现节流函数（throttle）
      </a></span> <span class="next"><a href="/guides/written/new.html">
        手写实现New操作符
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.06527024.js" defer></script><script src="/assets/js/2.be1a4e3a.js" defer></script><script src="/assets/js/84.e42a6c85.js" defer></script>
  </body>
</html>
